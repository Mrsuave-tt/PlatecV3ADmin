{"ast":null,"code":"import { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, collection, doc, getDoc, query, where, orderBy, getDocs, updateDoc, onSnapshot } from 'firebase/firestore';\nimport firebaseConfig from '../config/firebaseConfig';\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nexport { auth, db };\nexport const loginUser = async (email, password) => {\n  try {\n    const userCredential = await signInWithEmailAndPassword(auth, email, password);\n    return {\n      success: true,\n      user: userCredential.user\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const logoutUser = async () => {\n  try {\n    await signOut(auth);\n    return {\n      success: true\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const onAuthStateChangedListener = callback => {\n  return onAuthStateChanged(auth, callback);\n};\nexport const getUserData = async userId => {\n  try {\n    const docRef = doc(db, 'users', userId);\n    const docSnap = await getDoc(docRef);\n    if (docSnap.exists()) {\n      return {\n        success: true,\n        data: docSnap.data()\n      };\n    } else {\n      return {\n        success: false,\n        error: 'User not found'\n      };\n    }\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const getStudentAttendance = async (studentId, startDate = null, endDate = null) => {\n  try {\n    let q = query(collection(db, 'attendance'), where('studentId', '==', studentId), orderBy('date', 'desc'));\n    if (startDate) {\n      q = query(q, where('date', '>=', startDate));\n    }\n    if (endDate) {\n      q = query(q, where('date', '<=', endDate));\n    }\n    const querySnapshot = await getDocs(q);\n    const attendance = [];\n    querySnapshot.forEach(doc => {\n      attendance.push(Object.assign({\n        id: doc.id\n      }, doc.data()));\n    });\n    return {\n      success: true,\n      data: attendance\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const getStudentNotifications = async studentId => {\n  try {\n    const q = query(collection(db, 'notifications'), where('studentId', '==', studentId), orderBy('date', 'desc'));\n    const querySnapshot = await getDocs(q);\n    const notifications = [];\n    querySnapshot.forEach(doc => {\n      notifications.push(Object.assign({\n        id: doc.id\n      }, doc.data()));\n    });\n    return {\n      success: true,\n      data: notifications\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const markNotificationAsRead = async notificationId => {\n  try {\n    await updateDoc(doc(db, 'notifications', notificationId), {\n      read: true\n    });\n    return {\n      success: true\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\nexport const listenToStudentNotifications = (studentId, callback) => {\n  console.log('ðŸ”” Setting up notification listener for student:', studentId);\n  const q = query(collection(db, 'notifications'), where('studentId', '==', studentId), orderBy('timestamp', 'desc'));\n  return onSnapshot(q, querySnapshot => {\n    const notifications = [];\n    querySnapshot.forEach(doc => {\n      console.log('ðŸ“± Found notification:', doc.id, doc.data());\n      notifications.push(Object.assign({\n        id: doc.id\n      }, doc.data()));\n    });\n    console.log('ðŸ”” Real-time notifications updated:', notifications.length);\n    console.log('ðŸ“Š All notifications:', notifications);\n    callback(notifications);\n  }, error => {\n    console.error('âŒ Real-time notifications error:', error);\n  });\n};\nexport const listenToStudentAttendance = (studentId, callback) => {\n  const q = query(collection(db, 'attendance'), where('studentId', '==', studentId), orderBy('date', 'desc'));\n  return onSnapshot(q, querySnapshot => {\n    const attendance = [];\n    querySnapshot.forEach(doc => {\n      attendance.push(Object.assign({\n        id: doc.id\n      }, doc.data()));\n    });\n    console.log('ðŸ“Š Real-time attendance updated:', attendance.length);\n    callback(attendance);\n  }, error => {\n    console.error('âŒ Real-time attendance error:', error);\n  });\n};\nexport const getAttendanceStats = attendanceRecords => {\n  const total = attendanceRecords.length;\n  const present = attendanceRecords.filter(a => a.status === 'present').length;\n  const absent = attendanceRecords.filter(a => a.status === 'absent').length;\n  const late = attendanceRecords.filter(a => a.status === 'late').length;\n  return {\n    total,\n    present,\n    absent,\n    late,\n    presentPercent: total > 0 ? Math.round(present / total * 100) : 0\n  };\n};","map":{"version":3,"names":["initializeApp","getAuth","signInWithEmailAndPassword","signOut","onAuthStateChanged","getFirestore","collection","doc","getDoc","query","where","orderBy","getDocs","updateDoc","onSnapshot","firebaseConfig","app","auth","db","loginUser","email","password","userCredential","success","user","error","message","logoutUser","onAuthStateChangedListener","callback","getUserData","userId","docRef","docSnap","exists","data","getStudentAttendance","studentId","startDate","endDate","q","querySnapshot","attendance","forEach","push","Object","assign","id","getStudentNotifications","notifications","markNotificationAsRead","notificationId","read","listenToStudentNotifications","console","log","length","listenToStudentAttendance","getAttendanceStats","attendanceRecords","total","present","filter","a","status","absent","late","presentPercent","Math","round"],"sources":["C:/Users/Vincent/Desktop/attendance-system/mobile/src/services/firebase.js"],"sourcesContent":["import { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, collection, doc, getDoc, query, where, orderBy, getDocs, updateDoc, onSnapshot } from 'firebase/firestore';\nimport firebaseConfig from '../config/firebaseConfig';\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\n// Export auth and db properly\nexport { auth, db };\n\n// Authentication\nexport const loginUser = async (email, password) => {\n  try {\n    const userCredential = await signInWithEmailAndPassword(auth, email, password);\n    return { success: true, user: userCredential.user };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\nexport const logoutUser = async () => {\n  try {\n    await signOut(auth);\n    return { success: true };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\nexport const onAuthStateChangedListener = (callback) => {\n  return onAuthStateChanged(auth, callback);\n};\n\n// User Data\nexport const getUserData = async (userId) => {\n  try {\n    const docRef = doc(db, 'users', userId);\n    const docSnap = await getDoc(docRef);\n    if (docSnap.exists()) {\n      return { success: true, data: docSnap.data() };\n    } else {\n      return { success: false, error: 'User not found' };\n    }\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\n// Attendance\nexport const getStudentAttendance = async (studentId, startDate = null, endDate = null) => {\n  try {\n    let q = query(\n      collection(db, 'attendance'),\n      where('studentId', '==', studentId),\n      orderBy('date', 'desc')\n    );\n    \n    if (startDate) {\n      q = query(q, where('date', '>=', startDate));\n    }\n    if (endDate) {\n      q = query(q, where('date', '<=', endDate));\n    }\n    \n    const querySnapshot = await getDocs(q);\n    const attendance = [];\n    querySnapshot.forEach((doc) => {\n      attendance.push({ id: doc.id, ...doc.data() });\n    });\n    return { success: true, data: attendance };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\n// Notifications\nexport const getStudentNotifications = async (studentId) => {\n  try {\n    const q = query(\n      collection(db, 'notifications'),\n      where('studentId', '==', studentId),\n      orderBy('date', 'desc')\n    );\n    const querySnapshot = await getDocs(q);\n    const notifications = [];\n    querySnapshot.forEach((doc) => {\n      notifications.push({ id: doc.id, ...doc.data() });\n    });\n    return { success: true, data: notifications };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\nexport const markNotificationAsRead = async (notificationId) => {\n  try {\n    await updateDoc(doc(db, 'notifications', notificationId), { read: true });\n    return { success: true };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n};\n\n// Real-time notification listener\nexport const listenToStudentNotifications = (studentId, callback) => {\n  console.log('ðŸ”” Setting up notification listener for student:', studentId);\n  \n  const q = query(\n    collection(db, 'notifications'),\n    where('studentId', '==', studentId),\n    orderBy('timestamp', 'desc')\n  );\n  \n  return onSnapshot(q, (querySnapshot) => {\n    const notifications = [];\n    querySnapshot.forEach((doc) => {\n      console.log('ðŸ“± Found notification:', doc.id, doc.data());\n      notifications.push({ id: doc.id, ...doc.data() });\n    });\n    console.log('ðŸ”” Real-time notifications updated:', notifications.length);\n    console.log('ðŸ“Š All notifications:', notifications);\n    callback(notifications);\n  }, (error) => {\n    console.error('âŒ Real-time notifications error:', error);\n  });\n};\n\n// Real-time attendance listener\nexport const listenToStudentAttendance = (studentId, callback) => {\n  const q = query(\n    collection(db, 'attendance'),\n    where('studentId', '==', studentId),\n    orderBy('date', 'desc')\n  );\n  \n  return onSnapshot(q, (querySnapshot) => {\n    const attendance = [];\n    querySnapshot.forEach((doc) => {\n      attendance.push({ id: doc.id, ...doc.data() });\n    });\n    console.log('ðŸ“Š Real-time attendance updated:', attendance.length);\n    callback(attendance);\n  }, (error) => {\n    console.error('âŒ Real-time attendance error:', error);\n  });\n};\n\n// Get attendance statistics\nexport const getAttendanceStats = (attendanceRecords) => {\n  const total = attendanceRecords.length;\n  const present = attendanceRecords.filter(a => a.status === 'present').length;\n  const absent = attendanceRecords.filter(a => a.status === 'absent').length;\n  const late = attendanceRecords.filter(a => a.status === 'late').length;\n  \n  return {\n    total,\n    present,\n    absent,\n    late,\n    presentPercent: total > 0 ? Math.round((present / total) * 100) : 0\n  };\n};\n"],"mappings":"AAAA,SAASA,aAAa,QAAQ,cAAc;AAC5C,SAASC,OAAO,EAAEC,0BAA0B,EAAEC,OAAO,EAAEC,kBAAkB,QAAQ,eAAe;AAChG,SAASC,YAAY,EAAEC,UAAU,EAAEC,GAAG,EAAEC,MAAM,EAAEC,KAAK,EAAEC,KAAK,EAAEC,OAAO,EAAEC,OAAO,EAAEC,SAAS,EAAEC,UAAU,QAAQ,oBAAoB;AACjI,OAAOC,cAAc,MAAM,0BAA0B;AAGrD,MAAMC,GAAG,GAAGhB,aAAa,CAACe,cAAc,CAAC;AACzC,MAAME,IAAI,GAAGhB,OAAO,CAACe,GAAG,CAAC;AACzB,MAAME,EAAE,GAAGb,YAAY,CAACW,GAAG,CAAC;AAG5B,SAASC,IAAI,EAAEC,EAAE;AAGjB,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAOC,KAAK,EAAEC,QAAQ,KAAK;EAClD,IAAI;IACF,MAAMC,cAAc,GAAG,MAAMpB,0BAA0B,CAACe,IAAI,EAAEG,KAAK,EAAEC,QAAQ,CAAC;IAC9E,OAAO;MAAEE,OAAO,EAAE,IAAI;MAAEC,IAAI,EAAEF,cAAc,CAACE;IAAK,CAAC;EACrD,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAED,OAAO,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;EACpC,IAAI;IACF,MAAMxB,OAAO,CAACc,IAAI,CAAC;IACnB,OAAO;MAAEM,OAAO,EAAE;IAAK,CAAC;EAC1B,CAAC,CAAC,OAAOE,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAED,OAAO,MAAME,0BAA0B,GAAIC,QAAQ,IAAK;EACtD,OAAOzB,kBAAkB,CAACa,IAAI,EAAEY,QAAQ,CAAC;AAC3C,CAAC;AAGD,OAAO,MAAMC,WAAW,GAAG,MAAOC,MAAM,IAAK;EAC3C,IAAI;IACF,MAAMC,MAAM,GAAGzB,GAAG,CAACW,EAAE,EAAE,OAAO,EAAEa,MAAM,CAAC;IACvC,MAAME,OAAO,GAAG,MAAMzB,MAAM,CAACwB,MAAM,CAAC;IACpC,IAAIC,OAAO,CAACC,MAAM,CAAC,CAAC,EAAE;MACpB,OAAO;QAAEX,OAAO,EAAE,IAAI;QAAEY,IAAI,EAAEF,OAAO,CAACE,IAAI,CAAC;MAAE,CAAC;IAChD,CAAC,MAAM;MACL,OAAO;QAAEZ,OAAO,EAAE,KAAK;QAAEE,KAAK,EAAE;MAAiB,CAAC;IACpD;EACF,CAAC,CAAC,OAAOA,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAGD,OAAO,MAAMU,oBAAoB,GAAG,MAAAA,CAAOC,SAAS,EAAEC,SAAS,GAAG,IAAI,EAAEC,OAAO,GAAG,IAAI,KAAK;EACzF,IAAI;IACF,IAAIC,CAAC,GAAG/B,KAAK,CACXH,UAAU,CAACY,EAAE,EAAE,YAAY,CAAC,EAC5BR,KAAK,CAAC,WAAW,EAAE,IAAI,EAAE2B,SAAS,CAAC,EACnC1B,OAAO,CAAC,MAAM,EAAE,MAAM,CACxB,CAAC;IAED,IAAI2B,SAAS,EAAE;MACbE,CAAC,GAAG/B,KAAK,CAAC+B,CAAC,EAAE9B,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE4B,SAAS,CAAC,CAAC;IAC9C;IACA,IAAIC,OAAO,EAAE;MACXC,CAAC,GAAG/B,KAAK,CAAC+B,CAAC,EAAE9B,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE6B,OAAO,CAAC,CAAC;IAC5C;IAEA,MAAME,aAAa,GAAG,MAAM7B,OAAO,CAAC4B,CAAC,CAAC;IACtC,MAAME,UAAU,GAAG,EAAE;IACrBD,aAAa,CAACE,OAAO,CAAEpC,GAAG,IAAK;MAC7BmC,UAAU,CAACE,IAAI,CAAAC,MAAA,CAAAC,MAAA;QAAGC,EAAE,EAAExC,GAAG,CAACwC;MAAE,GAAKxC,GAAG,CAAC4B,IAAI,CAAC,CAAC,CAAE,CAAC;IAChD,CAAC,CAAC;IACF,OAAO;MAAEZ,OAAO,EAAE,IAAI;MAAEY,IAAI,EAAEO;IAAW,CAAC;EAC5C,CAAC,CAAC,OAAOjB,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAGD,OAAO,MAAMsB,uBAAuB,GAAG,MAAOX,SAAS,IAAK;EAC1D,IAAI;IACF,MAAMG,CAAC,GAAG/B,KAAK,CACbH,UAAU,CAACY,EAAE,EAAE,eAAe,CAAC,EAC/BR,KAAK,CAAC,WAAW,EAAE,IAAI,EAAE2B,SAAS,CAAC,EACnC1B,OAAO,CAAC,MAAM,EAAE,MAAM,CACxB,CAAC;IACD,MAAM8B,aAAa,GAAG,MAAM7B,OAAO,CAAC4B,CAAC,CAAC;IACtC,MAAMS,aAAa,GAAG,EAAE;IACxBR,aAAa,CAACE,OAAO,CAAEpC,GAAG,IAAK;MAC7B0C,aAAa,CAACL,IAAI,CAAAC,MAAA,CAAAC,MAAA;QAAGC,EAAE,EAAExC,GAAG,CAACwC;MAAE,GAAKxC,GAAG,CAAC4B,IAAI,CAAC,CAAC,CAAE,CAAC;IACnD,CAAC,CAAC;IACF,OAAO;MAAEZ,OAAO,EAAE,IAAI;MAAEY,IAAI,EAAEc;IAAc,CAAC;EAC/C,CAAC,CAAC,OAAOxB,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAED,OAAO,MAAMwB,sBAAsB,GAAG,MAAOC,cAAc,IAAK;EAC9D,IAAI;IACF,MAAMtC,SAAS,CAACN,GAAG,CAACW,EAAE,EAAE,eAAe,EAAEiC,cAAc,CAAC,EAAE;MAAEC,IAAI,EAAE;IAAK,CAAC,CAAC;IACzE,OAAO;MAAE7B,OAAO,EAAE;IAAK,CAAC;EAC1B,CAAC,CAAC,OAAOE,KAAK,EAAE;IACd,OAAO;MAAEF,OAAO,EAAE,KAAK;MAAEE,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC;EACjD;AACF,CAAC;AAGD,OAAO,MAAM2B,4BAA4B,GAAGA,CAAChB,SAAS,EAAER,QAAQ,KAAK;EACnEyB,OAAO,CAACC,GAAG,CAAC,kDAAkD,EAAElB,SAAS,CAAC;EAE1E,MAAMG,CAAC,GAAG/B,KAAK,CACbH,UAAU,CAACY,EAAE,EAAE,eAAe,CAAC,EAC/BR,KAAK,CAAC,WAAW,EAAE,IAAI,EAAE2B,SAAS,CAAC,EACnC1B,OAAO,CAAC,WAAW,EAAE,MAAM,CAC7B,CAAC;EAED,OAAOG,UAAU,CAAC0B,CAAC,EAAGC,aAAa,IAAK;IACtC,MAAMQ,aAAa,GAAG,EAAE;IACxBR,aAAa,CAACE,OAAO,CAAEpC,GAAG,IAAK;MAC7B+C,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEhD,GAAG,CAACwC,EAAE,EAAExC,GAAG,CAAC4B,IAAI,CAAC,CAAC,CAAC;MACzDc,aAAa,CAACL,IAAI,CAAAC,MAAA,CAAAC,MAAA;QAAGC,EAAE,EAAExC,GAAG,CAACwC;MAAE,GAAKxC,GAAG,CAAC4B,IAAI,CAAC,CAAC,CAAE,CAAC;IACnD,CAAC,CAAC;IACFmB,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEN,aAAa,CAACO,MAAM,CAAC;IACxEF,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEN,aAAa,CAAC;IACnDpB,QAAQ,CAACoB,aAAa,CAAC;EACzB,CAAC,EAAGxB,KAAK,IAAK;IACZ6B,OAAO,CAAC7B,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;EAC1D,CAAC,CAAC;AACJ,CAAC;AAGD,OAAO,MAAMgC,yBAAyB,GAAGA,CAACpB,SAAS,EAAER,QAAQ,KAAK;EAChE,MAAMW,CAAC,GAAG/B,KAAK,CACbH,UAAU,CAACY,EAAE,EAAE,YAAY,CAAC,EAC5BR,KAAK,CAAC,WAAW,EAAE,IAAI,EAAE2B,SAAS,CAAC,EACnC1B,OAAO,CAAC,MAAM,EAAE,MAAM,CACxB,CAAC;EAED,OAAOG,UAAU,CAAC0B,CAAC,EAAGC,aAAa,IAAK;IACtC,MAAMC,UAAU,GAAG,EAAE;IACrBD,aAAa,CAACE,OAAO,CAAEpC,GAAG,IAAK;MAC7BmC,UAAU,CAACE,IAAI,CAAAC,MAAA,CAAAC,MAAA;QAAGC,EAAE,EAAExC,GAAG,CAACwC;MAAE,GAAKxC,GAAG,CAAC4B,IAAI,CAAC,CAAC,CAAE,CAAC;IAChD,CAAC,CAAC;IACFmB,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEb,UAAU,CAACc,MAAM,CAAC;IAClE3B,QAAQ,CAACa,UAAU,CAAC;EACtB,CAAC,EAAGjB,KAAK,IAAK;IACZ6B,OAAO,CAAC7B,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;EACvD,CAAC,CAAC;AACJ,CAAC;AAGD,OAAO,MAAMiC,kBAAkB,GAAIC,iBAAiB,IAAK;EACvD,MAAMC,KAAK,GAAGD,iBAAiB,CAACH,MAAM;EACtC,MAAMK,OAAO,GAAGF,iBAAiB,CAACG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,SAAS,CAAC,CAACR,MAAM;EAC5E,MAAMS,MAAM,GAAGN,iBAAiB,CAACG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,QAAQ,CAAC,CAACR,MAAM;EAC1E,MAAMU,IAAI,GAAGP,iBAAiB,CAACG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,MAAM,CAAC,CAACR,MAAM;EAEtE,OAAO;IACLI,KAAK;IACLC,OAAO;IACPI,MAAM;IACNC,IAAI;IACJC,cAAc,EAAEP,KAAK,GAAG,CAAC,GAAGQ,IAAI,CAACC,KAAK,CAAER,OAAO,GAAGD,KAAK,GAAI,GAAG,CAAC,GAAG;EACpE,CAAC;AACH,CAAC","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}